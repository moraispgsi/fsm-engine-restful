/**
 * Created by Ricardo Morais on 28/03/2017.
 */

let lowLevelActions = require('./lowLevelActions');

let $a = lowLevelActions.makeAction;
let $t = $a.transition;
let $i = (property) => $a.getInstanceProperty(property);
let $is = (property, value) => $a.setInstanceProperty(property, value);
let $d = (property) => $a.getDataProperty(property);
let $ds = (property, value) => $a.setDataProperty(property, value);
let $f = $a.getFixed;
let $seq = $a.actionSequence;
let $c = $a.context;
let $http = $a.httpRequest;
let $log = $a.log;

/*
high lever actions come in this format
actionArguments: {
   argName1: value1,
   argName2: value2
}
*/
module.exports = function(prototype){

    prototype.eval = function(context, actionArguments) {
        let script = actionArguments.script;
        eval(script);
    };
    prototype.log = function(context, actionArguments) {
        let title = actionArguments.title;
        let text = actionArguments.text;
        return $log(title, text)(context, null);
    };
    prototype.setInstanceProperty = function(context, actionArguments) {
        let prop = actionArguments.propertyName;
        let val = actionArguments.value;
        return $is(prop, val)(context, null);
    };
    prototype.transition = function(actionArguments) {
        let state = actionArguments.state;
        return $t(state);
    };
    prototype.timerLog = function(actionArguments) {
        let delay = actionArguments.delay;
        let timerID = actionArguments.timerID;
        let title = actionArguments.title;
        let text = actionArguments.text;
        return $is(timerID, $a.timeout(delay, $a.log(title, text)));
    };
    prototype.cancelTimer = function(actionArguments){
        let timerID = actionArguments.timerID;
        return $a.cancelTimeout($i(timerID))(this, this.data);
    }

};